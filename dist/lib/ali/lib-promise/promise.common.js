(typeof window === 'undefined') && (window = {ctrl: {}, lib: {}});!window.ctrl && (window.ctrl = {});!window.lib && (window.lib = {});!function(a,b){function c(){this.ES6Promise=e,this.defer=function(){var a={},b=new e(function(b,c){a.resolve=b,a.reject=c});return a.promise=b,a},this.wrap=function(a){var b=this;return function(){if("function"==typeof a){var c=b.defer(),d=(c.promise,[c.resolve,c.reject].concat(Array.prototype.slice.call(arguments))),e=a.apply(this,d);return b.isPromise(e)?e:c.promise}return a}},this.mixin=function(a,b){return["then","catch"].forEach(function(c){b[c]=function(){return a[c].apply(a,arguments)}}),b},this.isThenable=function(a){return!!a&&!!a.then&&"function"==typeof a.then},this.isPromise=function(a){return!!(a instanceof e)},this.record=function(a){var b=Object.create(a);if(Object.defineProperties){var c,d="pending";Object.defineProperties(b,{PromiseState:{get:function(){return d},enmurable:!1},PromiseResult:{get:function(){return c},enmurable:!1}}),a.then(function(a){d="fullfilled",c=a},function(a){d="rejected",c=a})}else b.PromiseState="pending",b.PromiseResult=void 0,a.then(function(a){b.PromiseState="fullfilled",b.PromiseResult=a},function(a){b.PromiseState="rejected",b.PromiseResult=a});return b}}function d(){var a=new e(function(a){"complete"===document.readyState?a():document.addEventListener("DOMContentLoaded",a)});this.domReady=function(){return a};var c=new e(function(a){window.addEventListener("load",a)});this.pageLoad=function(){return c},this.delay=function(a){return new e(function(b){setTimeout(b,a)})},this.waitForEvent=function(a,b,c){return new e(function(d){function e(c){a.removeEventListener(b,e),d(c)}a.addEventListener(b,e,c)})},this.parallel=function(a){return e.all(a.map(function(a){return b.promise.features.isThenable(a)?e.resolve(a):"function"==typeof a?a():a}))},this.serial=function(a){var c=e.resolve();return a.forEach(function(a){c=c.then(b.promise.features.isThenable(a)?function(){return e.resolve(a)}:"function"==typeof a?a:function(){return a})}),c}}var e=a.Promise;if(!e)throw new Error("ES6Promise is not working in this browser");var f=new c,g=new d;b.promise=Object.create(f),b.promise.features=f,b.promise.utilities=g}(window,window.lib||(window.lib={}));;module.exports = window.lib.promise;